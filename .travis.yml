sudo: required
dist: trusty
language: node_js
node_js:
  - "5"
env:
  global:
  - GIT_REPO_ASCIIDOCTOR_STYLESHEET: "https://github.com/asciidoctor/asciidoctor-stylesheet-factory.git"
  - GIT_STYLES_DIR:  "$TRAVIS_BUILD_DIR/asciidoctor-styles"
install:
  - gem install --version '0.12.7' compass
  - gem install --version '4.3.2' zurb-foundation
before_script:
  - echo "Git clone the Asciidoctor Stylesheet Factory project and compile the css files using ruby compass"
  - git clone $GIT_REPO_ASCIIDOCTOR_STYLESHEET $GIT_STYLES_DIR
  - cd $GIT_STYLES_DIR
  - mkdir -p $GIT_STYLES_DIR/stylesheets/foundation
  - compass compile
script:
  - mkdir -p $TRAVIS_BUILD_DIR/assets/css
  - cp -R $GIT_STYLES_DIR/stylesheets $TRAVIS_BUILD_DIR/assets/css
  - cd $TRAVIS_BUILD_DIR/litoria && make
after_success:
  - cd $TRAVIS_BUILD_DIR/assets/
  - git init
  - git config user.name "${GH_USER_NAME}"
  - git config user.email "{GH_USER_EMAIL}"
  - git add . ; git commit -m "Deploy to Releases branch the assets"
  - git push --force --quiet "https://${GH_TOKEN}@${GH_REF}" master:releases > /dev/null 2>&1
notifications:
  email:
    recipients:
      - ch007m@gmail.com
    on_success: change # default: change
    on_failure: always # default: always